[{"name":"app.R","content":"library(shiny)\r\n\r\n\r\n\r\n ui <- fluidPage(\r\n  tags$head(tags$style(HTML(\"\r\n    body {text-align: center; background: #3C5E3E; color: #E4D7A1; font-family: 'Verdana', sans-serif;}\r\n    .container-fluid { max-width: 800px; margin: auto; padding-top: 20px; }\r\n    h1, h3 { text-align: center; color: #D6C17C; text-shadow: 0 0 10px rgba(246,211,101,0.5); }\r\n    .pill-btn {\r\n      display: block; margin: 20px auto; width: 200px; height: 200px;\r\n      border-radius: 50%; border: none; cursor: pointer;\r\n      font-size: 100px; background: #D6C17C;\r\n      box-shadow: 0 8px 20px rgba(0,0,0,0.4), inset 0 -4px 10px rgba(0,0,0,0.3);\r\n      transition: transform 0.08s;\r\n      line-height: 200px; text-align: center; padding: 0;\r\n    }\r\n    .pill-btn:hover { transform: scale(1.05); }\r\n    .cpill-btn:active { transform: scale(0.95); }\r\n    .score { text-align: center; font-size: 2.5em; color: #D6C17C; margin: 10px 0; }\r\n    .score-box {\r\n      flex: 1; width: 100%; padding: 5px; margin: 6px 0; border: 1px solid #D6C17C;\r\n      border-radius: 8px; background: #D6C17C; text-align: center;\r\n      font-size: 1.4em; color: #3C5E3E;\r\n    }\r\n    .score-label { font-size: 0.6em; color: #3C5E3E; margin-bottom: 4px; }\r\n    .stats-row { display: flex; gap: 10px; justify-content: center; margin-bottom: 20px; }\r\n    .stat-box {\r\n      flex: 1; max-width: 200px; padding: 5px; border: 1px solid #5F7D61;\r\n      border-radius: 8px; background: #5F7D61; text-align: center;\r\n      font-size: 1.4em; color: #D6C17C;\r\n    }\r\n    .stat-label { font-size: 0.6em; color: #D6C17C; margin-bottom: 4px; }\r\n    .shop-title { color: #D6C17C; font-size: 1.4em; border-bottom: 2px solid #5F7D61; padding-bottom: 5px; }\r\n    .upgrade-btn {\r\n      width: 100%; padding: 12px 15px; margin: 6px 0; border: 1px solid #D6C17C;\r\n      border-radius: 8px; background: #5F7D61; color: #D6C17C; cursor: pointer;\r\n      font-size: 1em; text-align: left; transition: background 0.2s;\r\n    }\r\n    .upgrade-btn:hover { background: #3C5E3E; }\r\n    .upgrade-btn:disabled { opacity: 0.4; cursor: not-allowed; }\r\n    .upgrade-info { float: right; color: #D6C17C; font-weight: bold; }\r\n  \"))),\r\n\r\n  h1(\"ClickerRx\"),\r\n  p(\r\n    \"Click the pill to produce pills, then spend them on upgrades to make even more pills!\",\r\n    tags$br(),\r\n    \"This game is made in Râœ¨ for \",\r\n    tags$a(\"CPDSE\",\r\n           href = \"https://www.cpdse.dk\",\r\n           target = \"_blank\",\r\n           style = \"color: #A9BBAA;\"),\r\n    \".\",\r\n    style = \"text-align: center; color: #E4D7A1; font-style: italic;\"\r\n  ),\r\n  div(class = \"score-box\", div(class = \"score-label\", \"You have\"), textOutput(\"pill_count\", inline = TRUE)),\r\n  div(class = \"stats-row\",\r\n      div(class = \"stat-box\", div(class = \"stat-label\", \"Pills per Click\"), textOutput(\"stat_click\", inline = TRUE)),\r\n      div(class = \"stat-box\", div(class = \"stat-label\", \"Pills per Second\"), textOutput(\"stat_pps\", inline = TRUE)),\r\n      div(class = \"stat-box\", div(class = \"stat-label\", \"Total Clicks\"), textOutput(\"stat_total\", inline = TRUE))\r\n  ),\r\n  \r\n  tags$button(id = \"click_pill\", class = \"pill-btn action-button\", HTML(\"ðŸ’Š\")),\r\n  \r\n  uiOutput(\"phd_message\"),\r\n  \r\n  br(),\r\n  div(class = \"shop-title\", \"ðŸ’° Shop\"),\r\n  \r\n  uiOutput(\"shop_ui\")\r\n  \r\n )\r\n\r\n server <- function(input, output, session) {\r\n  game_state <- reactiveValues(\r\n    pills = 0,\r\n    total_clicks = 0,\r\n    click_power = 1,\r\n    pps = 0,\r\n    upgrades = data.frame(\r\n      name = c(\r\n        # Early Game\r\n        \"CPDSE\", \r\n        \"read_csv\", \r\n        \"CodeClub\", \r\n        \"ggplot2\",\r\n        \r\n        # Mid Game\r\n        \"VLOOKUP Detox\", \r\n        \"Coding in R\", \r\n        \"R statistics Package\", \r\n        \"Degree\",\r\n        \r\n        # Late Game\r\n        \"Degree\"\r\n      ),\r\n      \r\n      emoji = c(\r\n        \"ðŸ\",\"ðŸ“„\",\"ðŸ¤²\",\"ðŸ“Š\",\r\n        \"ðŸ§®\",\"ðŸ‡·\",\"ðŸ“‰\",\"ðŸ’»\",\r\n        \"ðŸŽ“\"\r\n      ),\r\n      \r\n      desc = c(\r\n        \"You heard about CPDSE. Very cool!\",\r\n        \"You tamed a messy dataset. Commas fear you.\",\r\n        \"You join the CodeClub. There's code & cake!\",\r\n        \"Mastered your first ggplot2. The Tidyverse just got a hue upgrade!\",\r\n        \"You escaped Excel. There is no going back.\",\r\n        \"You know some R. Colleagues think you are a wizaRd.\",\r\n        \"p < 0.001. Very significant pills.\",\r\n        \"You feel comfortable handling your PC. People ask you if you can also fix the printer.\",\r\n        \"Finally! You are bilingual in data and drugs.\"\r\n      ),\r\n      \r\n      base_cost = c(\r\n        15, 50, 100, 120,   # Early\r\n        250, 600, 1500, 5000,  # Mid\r\n        10000  # Late\r\n      ),\r\n      \r\n      pps_add = c(\r\n        1, 0, 0, 5,\r\n        0, 12, 40, 0,\r\n        120\r\n      ),\r\n      \r\n      click_add = c(\r\n        0, 2, 3, 0,\r\n        5, 0, 0, 60,\r\n        0\r\n      ),\r\n      \r\n      owned = c(0,0,0,0,0,0,0,0,0),\r\n      stringsAsFactors = FALSE\r\n    )\r\n  )\r\n  \r\n  # raises 1.15 to the power of how many you own, creating exponential growth\r\n  get_cost <- function(base, owned) floor(base * 1.15^owned)\r\n  \r\n  # Pills that are auto-generated every second\r\n  observe({\r\n    invalidateLater(1000, session)\r\n    isolate({\r\n      game_state$pills <- game_state$pills + game_state$pps\r\n    })\r\n  })\r\n  \r\n  # Pills that are generated every click\r\n  observeEvent(input$click_pill, {\r\n    game_state$pills <- game_state$pills + game_state$click_power\r\n    game_state$total_clicks <- game_state$total_clicks + 1\r\n  })\r\n  \r\n  # Bying upgrades\r\n  lapply(seq_len(nrow(isolate(game_state$upgrades))), function(i) {\r\n    observeEvent(input[[paste0(\"buy_\", i)]], {\r\n      cost <- get_cost(game_state$upgrades$base_cost[i], game_state$upgrades$owned[i])\r\n      if (game_state$pills >= cost) {\r\n        game_state$pills <- game_state$pills - cost\r\n        game_state$upgrades$owned[i] <- game_state$upgrades$owned[i] + 1\r\n        game_state$pps <- game_state$pps + game_state$upgrades$pps_add[i]\r\n        game_state$click_power <- game_state$click_power + game_state$upgrades$click_add[i]\r\n      }\r\n    })\r\n  })\r\n  \r\n  output$pill_count <- renderText({\r\n    paste0(\"ðŸ’Š \", formatC(floor(game_state$pills), format = \"d\", big.mark = \",\"), \" pills\")\r\n  })\r\n  \r\n  output$stat_click <- renderText({ game_state$click_power })\r\n  output$stat_pps <- renderText({ game_state$pps })\r\n  output$stat_total <- renderText({ game_state$total_clicks })\r\n  \r\n  output$phd_message <- renderUI({\r\n    if (game_state$upgrades$owned[9] >= 3) {\r\n      h3(\"ðŸŽ“ Congratulations on reaching your 3rd degree! You've earned your PhD!\", \r\n         style = \"text-align: center; color: #D6C17C; margin-top: 20px;\")\r\n    }\r\n  })\r\n  \r\n  output$shop_ui <- renderUI({\r\n    ups <- game_state$upgrades\r\n    buttons <- lapply(1:nrow(ups), function(i) {\r\n      cost <- get_cost(ups$base_cost[i], ups$owned[i])\r\n      can_buy <- game_state$pills >= cost\r\n      desc <- if (ups$pps_add[i] > 0) {\r\n        paste0(\"+\", ups$pps_add[i], \" Pills per second\")\r\n      } else {\r\n        paste0(\"+\", ups$click_add[i], \" Pills per click\")\r\n      }\r\n      tags$button(\r\n        id = paste0(\"buy_\", i),\r\n        class = \"upgrade-btn action-button\",\r\n        disabled = if (!can_buy) \"disabled\" else NULL,\r\n        HTML(paste0(\r\n          ups$emoji[i], \" \", ups$name[i],\r\n          \" <small>(owned: \", ups$owned[i], \")<\/small>\",\r\n          \"<span class='upgrade-info'>\", desc, \" â€” Cost: \",\r\n          formatC(cost, format = \"d\", big.mark = \",\"), \" ðŸ’Š<\/span>\",\r\n          \"<br><small style='color:#E4D7A1;'>\", ups$desc[i], \"<\/small>\"\r\n        ))\r\n      )\r\n    })\r\n    do.call(tagList, buttons)\r\n  })\r\n  \r\n  \r\n }\r\n  \r\n\r\n# Run the application \r\nshinyApp(ui, server)\r\n","type":"text"}]
